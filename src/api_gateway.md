# API Gateway

* Is a service for publishing, maintaining, securing and monitoring APIs at scale
* Is an entry point to applications. It acts as an intermediary between a client and the backend service
* Is highly available, scalable, handles authorisation, throttling, caching, CORS, etc.
* It is able to handle and process large volumes of API calls
* It can be deployed as private, regional or edge-optimised using Cloudfront
* It supports 3 types of APIs:
    * REST API: using resources and methods and is feature-rich
    * HTTP API: lower latency and lower cost than REST APIs and supports minimal features eg. send request to a Lambda function or public HTTP endpoints
    * WebSocket API: stateful API eg. real-time applications eg. chat bot, dashboards, etc.

### Authentication

It supports a range of authentication methods: 

* Cognito use pools where the client receives a token in return.
* Lambda-based authorisation where the client passes a bearer token to the API Gateway and Lambda validates the request.

### Error codes generated by the API Gateway

* 4XX client error: invalid request on the client side

    - 400 bad request: generic client-side error
    - 403 access denied
    - 429 throttling: exceeded amount of requests

* 5XX server error: request is valid but backend issue

    - 502 bad gateway: bad output returned by the backend
    - 503 service unavailable
    - 504 timeout

### API Gateway stage

Is a logical reference to a lifecycle state of your API eg. dev, prod, beta, v2, etc. It is a named reference to a deployment of the API and is made available in the URL eg. `<API Gateway URL>/<stage>/<endpoint>`.

### API Gateway Integrations

API Gateway can take in a request and transform it to an integration request which is sent to the target backend service.

**Types of integrations**

* mock: used for testing, no backend involvement
* http: request/response are configured using mapping templates
* http proxy: request/response is not modified
* AWS: to expose AWS services
* AWS proxy: uses Lambda and no mapping is requried

**Mapping templates**

are used for http and AWS integration to modify or rename parameters, body, headers, etc. Uses the Velocity Template Language (VTL).

### OpenAPI Specification (OAS)

Defines a standard, language-agnostic interface to RESTful APIs which allows both humans and computers to discover and understand the capabilities of the service without access to source code, documentation or through network traffic inspection.

OAS was formally known as Swagger. Swagger is OpenAPI v2 and OpenAPI is now v3.

It is an API description format for REST APIs eg. endpoints, input/output parameters, authentication.

AWS API Gateway can export and import to Swagger/OAS.